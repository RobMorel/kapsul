<div id="capsule-form" data-controller="form-steps" data-action="turbo:submit-end->form-steps#handleErrors" class="container body-form d-flex align-items-center justify-content-center vh-100" >

  <%= simple_form_for @capsule do |f| %>
    <div>

      <div class="card-body">


        <div data-form-steps-target="step" class="step center-audio">

          <h3 class="text-center text-black fw-bold mb-4">Recording Kapsul</h3>

          <%= render "record" %>

          <div class="d-flex justify-content-between mt-3">
            <button type="button" class="btn btn-light text-white rounded-pill px-4" data-action="form-steps#nextStep">Next</button>
          </div>

          <div class="justify-content-center align-items-center progress-bar-container">
            <div class="rounded-pill size" style="background-color: #0B173F;"></div>
            <div class="rounded-pill size" style="background-color: #C8102E;"></div>
            <div class="rounded-pill size" style="background-color: #C8102E;"></div>
          </div>

        </div>

        <div data-form-steps-target="step" class="step d-none">

          <h3 class="text-center text-black fw-bold mb-4">Give us more details</h3>

          <div class="form-group mb-3">
            <%= f.input :title, required: true %>
          </div>
          <div class="form-group mb-3">
            <%= f.input :teasing, as: :text, required: true %>
          </div>
          <div class="form-group mb-3">
              <%= f.collection_select :category,
                          [['Histoire', 'histoire'],
                           ['Art', 'art'],
                           ['Love', 'love'],
                           ['Architecture', 'architecture'],
                           ['Horreur', 'horreur'],
                           ['Nature', 'nature'],
                           ['Fantasy', 'fantasy']],
                          :second,
                          :first,
                          { label: "Category", prompt: "Sélectionnez une catégorie", required: true },
                          { class: "form-control" } %>
          </div>

          <div class="d-flex justify-content-between mt-3">
            <button type="button" class="btn btn-light text-white rounded-pill px-4" data-action="form-steps#previousStep">Back</button>
            <button type="button" class="btn btn-light text-white rounded-pill px-4" data-action="form-steps#nextStep">Continue</button>
          </div>

          <div class="justify-content-center align-items-center progress-bar-container">
            <div class="rounded-pill size" style="background-color: #0B173F;"></div>
            <div class="rounded-pill size" style="background-color: #0B173F;"></div>
            <div class="rounded-pill size" style="background-color: #C8102E;"></div>
          </div>
        </div>

        <div data-form-steps-target="step" class="step d-none">

          <h3 class="text-center text-black fw-bold mb-4">Location & Photo</h3>

          <div class="form-group mb-3" data-controller="position">
          <%= f.input :address, required: true,
            input_html: {data: {address_autocomplete_target: "address", position_target: "address"}, class: "d-none"},
            wrapper_html: {data: {controller: "address-autocomplete", address_autocomplete_api_key_value: ENV["MAPBOX_API_KEY"]}}
          %>
          <button type="button" class="btn btn-secondary mt-2" data-position-target="button" data-action="position#getPosition">Set my current position</button>
          </div>

          <div class="form-group mb-3">
            <%= f.input :photo, as: :file, required: true %>
          </div>

          <div class="d-flex justify-content-between mt-3">
            <button type="button" class="btn btn-light text-white rounded-pill px-4" data-action="form-steps#previousStep">Back</button>
            <%= f.button :submit, "Submit", class: "btn btn-light text-white rounded-pill px-4" %>
          </div>

          <div class="justify-content-center align-items-center progress-bar-container">
            <div class="rounded-pill size" style="background-color: #0B173F;"></div>
            <div class="rounded-pill size" style="background-color: #0B173F;"></div>
            <div class="rounded-pill size" style="background-color: #0B173F;"></div>
          </div>

        </div>
      </div>
    </div>
 <% end %>
</div>
